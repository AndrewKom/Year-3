Практическая работа 1
================

## Цель работы

1.  Изучить возможности технологии Yandex Query для анализа
    структурированных наборов данных
2.  Получить навыки построения аналитического пайплайна для анализа
    данных с помощью сервисов Yandex Cloud
3.  Закрепить практические навыки использования SQL для анализа данных
    сетевой активности в сегментированной корпоративной сети

## Исходные данные

1.  ОС Windows
2.  Cервисы Yandex Cloud
3.  RStudio

## План

1.  Проверить доступность данных в Yandex Object Storage
2.  Подключить бакет как источник данных для Yandex Query
3.  Провести анализ данных
4.  Создать отчет

## Описание шагов:

1.  **Проверьте доступность данных** (файл yaqry_dataset.pqt) в бакете
    arrow-datasets S3 хранилища Yandex Object Storage. Проверить можно
    просто перейдя по правильно сконструированному URL в браузере.

    <https://storage.yandexcloud.net/arrow-datasets/yaqry_dataset.pqt>

2.  **Подключить бакет как источник данных для Yandex Query**

Yandex Query – это облачное решение для анализа данных, в котором задачи
организации хранения, обеспечения доступа и выполнения первичного
анализа данных полностью берет на себя сервис-провайдер, то есть Yandex
Cloud.

-   Войдем в свой аккаунт и подключимся к Yandex Cloud

![](foto1/1.png)

-   Создадим соединение для бакета в S3 хранилище.

-   Заполняем поля с учетом допустимых символов, выбираем тип
    аутентификации. Вводим имя бакета в соответствующее поле и
    сохраняем.

    ![](foto1/2.png)

-   Настроем привязку данных

    ![](foto1/3.png)

-   Опишем состав и формат входных данных

    ![](foto1/4.png)

Формат данных  
SCHEMA=( timestamp TIMESTAMP NOT NULL, src STRING, dst STRING, port
INT32, bytes INT32 )

-   Если настройки сделаны правильно, то можно попробовать сделать
    аналитический запрос и посмотреть результат

![](foto1/5.png)

1.  **Провести анализ данных**

**1 Известно, что IP адреса внутренней сети начинаются с октетов,
принадлежащих интервалу \[12-14\]. Определите количество хостов
внутренней сети, представленных в датасете.**

Запрос  
SELECT COUNT(distinct src) AS zad1

FROM \`datasetkom1\`

WHERE src REGEXP ‘(^12\\.)’ or src REGEXP ‘(^13\\.)’ or src REGEXP
‘(^14\\.)’;

Ответ  
1000

![](foto1/6.png)

**2 Определите суммарный объем исходящего трафика**

Запрос  
SELECT sum(bytes) as zad2

FROM \`datasetkom1\`

WHERE (src REGEXP ‘(^12\\.)’ or src REGEXP ‘(^13\\.)’ or src REGEXP
‘(^14\\.)’) and (dst not REGEXP ‘(^1\[2-4\]\\.)’)

Ответ  
6726396441 байт

``` r
kb <- 6726396441/1024
mb <- kb/1024
gb <- mb/1024
sprintf("%f Gb исходящего трафика", gb)
```

    [1] "6.264445 Gb исходящего трафика"

![](foto1/7.png)

**3 Определите суммарный объем входящего трафика**

Запрос  
SELECT sum(bytes) as zad3

FROM \`datasetkom1\`

WHERE (src not REGEXP ‘(^1\[2-4\]\\.)’) and (dst REGEXP
‘(^1\[2-4\]\\.)’)

Ответ  
12459379906 байт

``` r
kb <- 12459379906/1024
mb <- kb/1024
gb <- mb/1024
sprintf("%f Gb входящего трафика", gb)
```

    [1] "11.603702 Gb входящего трафика"

![](foto1/8.png)

**4 Создадим отчет в RSTUDIO**

## Оценка результатов

Задача выполнена при помощи облачных сервисов Yandex Cloud и технологии
Yandex Query, удалось познакомится с их функционалом и особенностями.

## Вывод

В данной работе я смог закрепить практические навыки использования SQL
для анализа данных сетевой активности в сегментированной корпоративной
сети и получить навыки построения аналитического пайплайна для анализа
данных
